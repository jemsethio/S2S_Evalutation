(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23382,        590]
NotebookOptionsPosition[     21787,        551]
NotebookOutlinePosition[     22573,        577]
CellTagsIndexPosition[     22495,        572]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 TogglerBox[1, {1->
  OverlayBox[{
   TagBox[GridBox[{
      {
       GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRIz
UFAKiEGSLED8//9/gvjRo0fsN27cELp69arY+fPnpZExPn137tzhBqrRBGJ/
ID4CxMfRMTZ9L168YL5w4YIaUD4AiC8C8Qcg/gvE/9AxFreC7PQD4gtA/BGq
7j8ujKz3+fPnLFC9b6H24dSHTf/FixfVofYSpRdZPzSsAqBuJkovsn5oOF8k
5F9s+h88eMBBjt0w/devXxcGso+S4m9k/ZcuXRKHpgeS3A7TD0wrkpToPw9J
ywOmn1L3Uxp+lMYfpemH0vRLjfwDjQey8y9a+fGOWDPwlF+gsPhEKDywlZ8g
d0D9EniexPITGd++fZv3PBnlN6764zxa3QHCAIDESDs=
         "], {{0, 26}, {16, 
         0}}, {0, 255},
         ColorFunction->RGBColor],
        BaseStyle->"ImageGraphics",
        ImageSize->Magnification[1],
        ImageSizeRaw->{16, 26},
        PlotRange->{{0, 16}, {0, 26}}], 
       GraphicsBox[RasterBox[CompressedData["
1:eJzt2V1vVFUUBuBGTfTSSygthYYKNHyVinrrpbcYfwBEJN5gUkyMfw9KKaVw
KCkQKCW1RNIQKg1gEE3QtdN10pMRZCaBzNQ+kzxt5nzstfeZfbPOu/vkD8e/
e6+vr+/sR/Hn+ImfvpyYOPHz1x/Hl2/OnP3+9JlT33515sdTp09NfHHy/TjY
H6592Nf3QfyvqmpHBwbCYNr5GoMNAw2d1AEAADa3/obtLba1aJ7rb4xR9x1D
YVfYHYbDnjASPgn7wv4wGg6Eg+FQOByOhLEwnj4Nx8Jn6fM21dcfyzHq8cay
xuGseTDnMJpz2pdzHMk5D+caduWa6v6p+czafU71s6p1+/cGAADYqt52/9va
++6tXt331j3v0TTeoj5e966v6lv3Vv/uWfWr9LJm9tzMpN+UW3eaVV9s00yY
CzfC7bAQFhvuhjt57maYD9er9c+VcDlcCtMd1AQAADafqXQhTabz6VyL+vhk
Xl/uLX1D6UFmw9VwrVrvL0o/cqta7ztKD3Iv/BLuh1/DSngYHoXfwlp4Ep6F
38Pz8Ed4Ef5Mf71Gff5F3vM8x3iWY65ljUdZcyXncD/ndC/neDvnfCPXcC3X
NJtrnG48r3afU/2s6uc11QO/OwAAwFbzLvrfksWVjK30kSV3KxncUlgOD6qN
vnc1PK42+t7iaaq/r+U1q9VG3/ogx1rKse9krfmsrV+l15R9WDLmkjWXzLl8
yvuVsmdLJl3eu5R9XN7BNLPrhTxX3seUvT3TQc2Xbfr7LWq3JgAAwH95m33K
u9Dt5wMAAMDmp2dlK+vGnu/2+yQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYPN42aZu
1AQAAAAAAICtrNsZIXRTN/b8xTbNhLlwI9wOC2Gx4W64k+duhvlwvVr/XAmX
w6Uw3UFNAAAAAAAA6EVT6UKaTOfTuRb18cm8vtxbcrOSwc2Gq9V6FlcytlvV
eu5WMrilsBwehJXwMKyGx2EtPElPU/19La9ZzXtWcozlHHMxa9zKmnM5h9mc
03Rjfe2uq15bvb6pHvid2NzKPiwZc8maS+ZcPiWDLnu2ZNIlmy77uGTVzex6
Ic+VbLvs7ZkOau7owEAYTDtfY7BhoKGTOgAAAAAAANDr+hu2t9jWonmuvzFG
nbsNhd1hOOwJI2Fv2B9Gw4FwMBwKR8JYOJrGW9THx/LaQ3nvgRxrf449krWG
s/ZQtZH3NdfY7rrqtdW6/fvw/9LMnpuZ9Jty646y6n8AhCP7tg==
         "], {{0, 26}, {
         2000, 0}}, {0, 255},
         ColorFunction->RGBColor],
        BaseStyle->"ImageGraphics",
        ImageSize->Magnification[1],
        ImageSizeRaw->{2000, 26},
        PlotRange->{{0, 2000}, {0, 26}}], 
       GraphicsBox[RasterBox[CompressedData["
1:eJy9lktLQkEUxyVdCBIELaxctYq+QduWbcKMPoCSRRsDC6JPp+Lj4vuq+EBc
iBtFfIYrpU7nPzQiN++9vmrgp/dx5j8z55w5c099z56HPYvF8mLnH4/37TIY
9L7fHvDNXeDl6THgv78KvPof/cELn5UfnjBHjI3J5/OudVBV9bhUKjmbzaad
iCxmcB9lAxKMmzmv1+v7JvpfG/DJjJkic8NrOut0OlYdfdoCjPXBqMx1q9Vy
7FhfgvX0MUa73bYZ6edyuTnrvPsZQ4Wv9PTRL5vNroTOGIiJu9FoOLT6UjuT
yVAqlaJkMin+0+m0YPEZbHTGQDwKyKtl+ugHjdFoRIVCgeLxOCUSCQGua7Ua
9Xo9YQNbozXI/aHVZ//RcDik2WxG5XKZwuGwANdo0JfrNIhDvFqtHi7zD+YW
i8VoMBgIvWKxKEDrdrtiHbAxiAF8pHAf5zJ9+Bca0WiUxuMxydbv98U64CvY
wNZgTyioI9r8QR/EEvrQUhRlrh8Kheb6sDHTZ1xG84ePMP/pdPpr/tvoL/of
Mcb9Jv7X+mcxP2X+QCMSiYh5VyoVMQbXMbP81I2vzM/JZCLyX+a+BPmPvbFN
fmr36pr713B/rVp7THy/tD6Y1cjF5zrahvVtB5jW5y21B/kVzpc1kecjfK53
Pu7kfNfO+x+/T/70++ob7NUEtQ==
         "], {{0, 26}, {24, 0}}, {0, 255},
         ColorFunction->RGBColor],
        BaseStyle->"ImageGraphics",
        ImageSize->Magnification[1],
        ImageSizeRaw->{24, 26},
        PlotRange->{{0, 24}, {0, 26}}]}
     },
     AutoDelete->False,
     GridBoxItemSize->{"Columns" -> {Automatic, 
         Scaled[0.6], Automatic}},
     GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}],
    "Grid"], 
   PaneBox[
    StyleBox[
     RowBox[{
     "Background", " ", "images", " ", "and", " ", "text", " ", "colors", " ",
       "have", " ", "been", " ", "adjusted", " ", "for", " ", "editing", " ", 
      
      RowBox[{"purposes", "."}]}],
     LineBreakWithin->False,
     FontFamily->"Helvetica",
     FontSize->12,
     FontColor->GrayLevel[0.4]],
    Alignment->Center,
    ImageSize->Scaled[0.5],
    ScrollPosition->{0., 0.}]},
   Alignment->{Center, Center}], 2->""}, "1"]], "SlideShowNavigationBar", \
"FirstSlide",
 CellMargins->{{0, 0}, {0, 0}},
 CellFrameLabelMargins->2,
 CellSize->{Inherited, 30},
 TextAlignment->Center,
 CellTags->
  "SlideShowHeader",ExpressionUUID->"ebc9565c-a2cf-403f-9ea0-ba6fd0d63b05"],

Cell["Evaluation", "Title",
 CellChangeTimes->{
  3.559948400406288*^9, {3.7147460916855583`*^9, 3.7147461049000263`*^9}, {
   3.714855863935565*^9, 
   3.71485586533362*^9}},ExpressionUUID->"c0b91f1b-a350-46f1-8ab3-\
46b2c0607e14"],

Cell["\<\
BX Pan
2017.9.18\
\>", "Text",
 CellChangeTimes->{{3.714746109452416*^9, 3.7147461155951366`*^9}},
 TextAlignment->Right,
 TextJustification->0.,ExpressionUUID->"6a25e1dd-d306-472b-abf7-4b76c14db25b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->
  "SlideShowHeader",ExpressionUUID->"97b70f0f-3448-4cfc-9277-10c2c876fd91"],

Cell[CellGroupData[{

Cell["Cutting", "Subchapter",
 CellChangeTimes->{{3.714850678503683*^9, 3.714850681230166*^9}, {
  3.714854831344328*^9, 
  3.714854832286189*^9}},ExpressionUUID->"b8b7b164-6382-403f-bfd5-\
b3a4e5280011"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S2SGridSelect", "[", 
   RowBox[{"polygon_", ",", "s2sdirectory_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "cpcprecip", ",", "cpclat", ",", "cpclon", ",", "cpctime", ",", "\n", 
      " ", "s2sprecip", ",", "s2slat", ",", "s2slon", ",", "s2stime", ",", 
      "\n", " ", 
      RowBox[{"year", "=", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"StringCases", "[", 
           RowBox[{"s2sdirectory", ",", 
            RowBox[{"\"\<_\>\"", "~~", "__", "~~", "\"\<-\>\""}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "5"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", " ", "interval", ",", 
      "\n", " ", "points", ",", "indexes", ",", "cpcdirectory"}], "}"}], ",", 
    "\n", "    ", 
    RowBox[{
     RowBox[{"cpcdirectory", "=", 
      RowBox[{
      "\"\</Users/lambda/Documents/Data/CPC_Precipitation/global/precip.\>\"",
        "<>", "year", "<>", "\"\<.nc\>\""}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cpcprecip", ",", "cpclat", ",", "cpclon", ",", "cpctime"}], 
       "}"}], "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"cpcdirectory", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Datasets\>\"", ",", "#"}], "}"}]}], "]"}], "&"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<precip\>\"", ",", "\"\<lat\>\"", ",", "\"\<lon\>\"", ",", 
          "\"\<time\>\""}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"s2sprecip", ",", "s2slat", ",", "s2slon", ",", "s2stime"}], 
       "}"}], "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"s2sdirectory", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Datasets\>\"", ",", "#"}], "}"}]}], "]"}], "&"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<tp\>\"", ",", "\"\<latitude\>\"", ",", "\"\<longitude\>\"", 
          ",", "\"\<time\>\""}], "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"interval", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"cpctime", "-", 
              RowBox[{"#", "[", "s2stime", "]"}]}], "]"}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"cpctime", "-", 
               RowBox[{"#", "[", "s2stime", "]"}]}], "]"}], "]"}]}], "]"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"Min", ",", "Max"}], "}"}]}], "]"}]}], ";", "\t", "\n", 
     "    ", 
     RowBox[{"cpcprecip", "=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"DownScale", ",", "size"}], "}"}], ",", "\n", "        ", 
        RowBox[{
         RowBox[{
          RowBox[{"DownScale", "[", 
           RowBox[{"data_", ",", "ratio_"}], "]"}], ":=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "convoluter", "}"}], ",", "\n", "\t\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{
             "This", " ", "Function", " ", "performs", " ", "spacial", " ", 
              "average", " ", "downscaling", " ", "of", " ", "2", "D", " ", 
              "data", " ", "through", " ", "uniform", " ", "convolution", " ",
               "ratio", " ", "is", " ", "kind", " ", "like", " ", 
              RowBox[{"{", 
               RowBox[{"5", ",", "4"}], "}"}]}], "*)"}], " ", "\n", "\t\t\t", 
            
            RowBox[{
             RowBox[{"convoluter", " ", "=", " ", 
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", "net", "}"}], ",", "\n", "   \t\t\t", 
                RowBox[{
                 RowBox[{"net", " ", "=", " ", 
                  RowBox[{"NetInitialize", "[", 
                   RowBox[{"ConvolutionLayer", "[", 
                    RowBox[{"1", ",", " ", "ratio", ",", " ", 
                    RowBox[{"\"\<Stride\>\"", " ", "->", " ", "ratio"}], ",", 
                    " ", "\n", "   \t\t\t\t\t\t", 
                    RowBox[{"\"\<Input\>\"", " ", "->", " ", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", " ", 
                    RowBox[{"Dimensions", "[", "data", "]"}]}], "}"}], 
                    "]"}]}]}], "]"}], "]"}]}], ";", "\n", "               ", 
                 RowBox[{"NetReplacePart", "[", 
                  RowBox[{"net", ",", " ", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Weights\>\"", " ", "->", " ", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"1.", "/", 
                    RowBox[{"(", 
                    RowBox[{"ratio", "/.", 
                    RowBox[{"List", "\[Rule]", "Times"}]}], ")"}]}], ",", " ", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", " ", "1", ",", " ", "ratio"}], "}"}], 
                    "]"}]}], "]"}]}], "}"}]}], "]"}]}]}], "]"}]}], ";", "\n", 
             "            ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"convoluter", "@", 
                RowBox[{"{", "data", "}"}]}], ")"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
         "        ", 
         RowBox[{"size", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"s2slat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"s2slat", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "/", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"cpclat", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"cpclat", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", "\n", 
            "          ", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"s2slon", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"s2slon", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "/", 
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"cpclon", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"cpclon", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "}"}]}], 
         ";", "\n", "        ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DownScale", "[", 
             RowBox[{"#", ",", "size"}], "]"}], "&"}], ",", 
           RowBox[{"cpcprecip", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"interval", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ";;", 
              RowBox[{"interval", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}]}], 
       "]"}]}], ";", "\n", "    ", 
     RowBox[{"points", "=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"InOrOut", ",", "grids"}], "}"}], ",", "\n", "        ", 
        RowBox[{
         RowBox[{
          RowBox[{"InOrOut", "[", "point_", "]"}], ":=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "singletest", "}"}], ",", "\n", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"singletest", "[", "poly_", "]"}], " ", ":=", " ", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Total", "@", " ", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", " ", "-", " ", 
                    RowBox[{"RotateRight", "[", "#", "]"}]}], ")"}], " ", 
                    "&"}], "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ArcTan", " ", "@@", " ", 
                    RowBox[{"(", 
                    RowBox[{"point", " ", "-", " ", "#"}], ")"}]}], " ", 
                    "&"}], " ", "/@", " ", "poly"}], ")"}]}], ",", " ", 
                    RowBox[{"2", " ", "Pi"}], ",", " ", 
                    RowBox[{"-", "Pi"}]}], "]"}]}], "/", "2"}], "/", "Pi"}], 
                 ")"}], "]"}], " ", "!=", " ", "0"}]}], ";", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Map", "[", 
                RowBox[{"singletest", ",", "polygon"}], "]"}], ")"}], "/.", 
              RowBox[{"List", "\[Rule]", "Or"}]}]}]}], "]"}]}], ";", "\n", 
         "        ", 
         RowBox[{"grids", "=", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"scope", "=", 
               RowBox[{"Map", "[", 
                RowBox[{"MinMax", ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"polygon", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
              ",", "lat", ",", "lon"}], "}"}], ",", "\n", "            ", 
            RowBox[{
             RowBox[{"lat", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"s2slat", ",", 
                RowBox[{
                 RowBox[{"And", "[", 
                  RowBox[{
                   RowBox[{"#", "<=", 
                    RowBox[{"scope", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", " ", 
                   RowBox[{"#", ">=", 
                    RowBox[{"scope", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "]"}], "&"}]}],
                "]"}]}], ";", "\n", "            ", 
             RowBox[{"lon", "=", 
              RowBox[{"Select", "[", 
               RowBox[{"s2slon", ",", 
                RowBox[{
                 RowBox[{"And", "[", 
                  RowBox[{
                   RowBox[{"#", "<=", 
                    RowBox[{"scope", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", " ", 
                   RowBox[{"#", ">=", 
                    RowBox[{"scope", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], "&"}]}],
                "]"}]}], ";", "\n", "        ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"lat", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                   RowBox[{"lon", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"Length", "[", "lon", "]"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "lat", "]"}]}], "}"}]}], "]"}]}]}], 
           "]"}]}], ";", "\n", "        ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"grids", ",", "1"}], "]"}], ",", 
           RowBox[{
            RowBox[{"InOrOut", "[", 
             RowBox[{"Reverse", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}]}], 
       "]"}]}], ";", "\n", "    ", 
     RowBox[{"indexes", "=", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"grids", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"s2slat", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"s2slon", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "s2slon", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "s2slat", "]"}]}], "}"}]}], "]"}]}], 
         "}"}], ",", "\n", "        ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"grids", ",", "#"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "points"}], "]"}]}], 
       "]"}]}], ";", "\n", "    ", 
     RowBox[{"cpcprecip", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cpcprecip", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], ",", 
        "indexes"}], "]"}]}], ";", "\n", "    ", 
     RowBox[{"s2sprecip", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"s2sprecip", "[", 
          RowBox[{"[", 
           RowBox[{";;", ",", ";;", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], ",", 
        "indexes"}], "]"}]}], ";", "\n", "    ", 
     RowBox[{"{", 
      RowBox[{"cpcprecip", ",", "s2sprecip", ",", "points"}], "}"}]}]}], 
   "]"}]}]], "Code",
 CellChangeTimes->{
  3.714855709571062*^9, {3.714916486290579*^9, 3.7149164882170963`*^9}, {
   3.71491719619144*^9, 3.7149172483024197`*^9}, {3.714917353264412*^9, 
   3.7149173580395317`*^9}, {3.714917394057719*^9, 3.714917400807756*^9}, {
   3.714917455425118*^9, 3.714917602355893*^9}, {3.7149176417823963`*^9, 
   3.7149176581485653`*^9}, {3.714917694657852*^9, 3.714917695672742*^9}, {
   3.714917829052971*^9, 3.7149178707868156`*^9}, {3.714918107063167*^9, 
   3.714918109087934*^9}},ExpressionUUID->"543eb00a-a46b-4f15-8222-\
7a199d70227c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"polygon", "=", 
   RowBox[{"westconus", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "s2sdirectory", "=", 
   "\"\</Users/lambda/Documents/Data/S2S/CMA/CMA_1994-01-01.nc\>\""}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.714852616245571*^9, 3.714852665801057*^9}, {
   3.714854405982801*^9, 3.7148544091322803`*^9}, {3.714854734238809*^9, 
   3.714854737870551*^9}, {3.714916056747917*^9, 3.714916064627496*^9}, {
   3.714916199929582*^9, 3.714916218704959*^9}, {3.7149162768370047`*^9, 
   3.714916352315222*^9}, 3.714916603998415*^9, {3.714916808603459*^9, 
   3.71491681014581*^9}, {3.714918141978342*^9, 
   3.7149181514959717`*^9}},ExpressionUUID->"62c3bdf2-67e0-4898-ac9f-\
651dbc59fef3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cpcprecip", ",", "s2sprecip", ",", "points"}], "}"}], "=", 
   RowBox[{"S2SGridSelect", "[", 
    RowBox[{"polygon", ",", "s2sdirectory"}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.7148535314328613`*^9, 3.714853550561183*^9}, {
   3.714916503019643*^9, 3.714916504180334*^9}, 
   3.714918330756813*^9},ExpressionUUID->"efe98b86-599e-447d-90ee-\
2adc8d39fe04"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->Automatic,
TaggingRules->{"SlideShow" -> True},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"SlideShow"}, "Garnet.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "SlideShowHeader"->{
  Cell[580, 22, 4399, 98, 75, "SlideShowNavigationBar",ExpressionUUID->"ebc9565c-a2cf-403f-9ea0-ba6fd0d63b05",
   CellTags->"SlideShowHeader"],
  Cell[5464, 140, 122, 2, 74, "SlideShowNavigationBar",ExpressionUUID->"97b70f0f-3448-4cfc-9277-10c2c876fd91",
   CellTags->"SlideShowHeader"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"SlideShowHeader", 22183, 564}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4399, 98, 75, "SlideShowNavigationBar",ExpressionUUID->"ebc9565c-a2cf-403f-9ea0-ba6fd0d63b05",
 CellTags->"SlideShowHeader"],
Cell[4982, 122, 232, 5, 311, "Title",ExpressionUUID->"c0b91f1b-a350-46f1-8ab3-46b2c0607e14"],
Cell[5217, 129, 210, 6, 93, "Text",ExpressionUUID->"6a25e1dd-d306-472b-abf7-4b76c14db25b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5464, 140, 122, 2, 74, "SlideShowNavigationBar",ExpressionUUID->"97b70f0f-3448-4cfc-9277-10c2c876fd91",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[5611, 146, 204, 4, 65, "Subchapter",ExpressionUUID->"b8b7b164-6382-403f-bfd5-b3a4e5280011"],
Cell[5818, 152, 14740, 364, 1159, "Code",ExpressionUUID->"543eb00a-a46b-4f15-8222-7a199d70227c"],
Cell[20561, 518, 765, 17, 103, "Code",ExpressionUUID->"62c3bdf2-67e0-4898-ac9f-651dbc59fef3"],
Cell[21329, 537, 430, 10, 70, "Code",ExpressionUUID->"efe98b86-599e-447d-90ee-2adc8d39fe04"]
}, Open  ]]
}, Open  ]]
}
]
*)

